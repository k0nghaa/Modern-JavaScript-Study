# 1️⃣ 모듈

- 모듈이란, 분리된 파일 하나하나를 말한다.
대개 클래스 하나 혹은 특정한 목적을 가진 복수의 함수로 구성된 라이브러리 하나로 구성됨
- export와 import 지시자를 적용하면 다른 모듈을 불러오고 호출하는 기능 공유가 가능해짐
- 브라우저에서 동작 시킬 땐, <script type=”module”> 과 같이 속성을 설정해 해당 스크립트가 모듈임을 알 수 있게 해야함
- 개념적으로는 알겠으나 머릿속에 잘 들어오지 않음.
- 그렇다면 대체 일반 스크립트와 모듈의 차이가 무엇일까?

## 모듈의 핵심 기능

1. 모듈은 항상 엄격 모드로 실행된다.
    - 엄격모드를 지키지 않은 코드는 에러를 발생시킴
2. 모듈은 자신만의 스코프가 있다.
    - 따라서 모듈 내부에서 정의한 변수나 함수는 다른 스크립트에서 접근할 수 없음
3. 동일한 모듈이 여러 곳에서 사용되더라도
모듈은 최초 호출 시 단 한 번만 실행된다.
    - **실무에선 최상위 레벨 모듈을 대개 초기화나 내부에서 쓰이는 데이터 구조를 만들고 이를 내보내 재사용하고 싶을 때 사용**
4. `import.meta` 객체로 현재 모듈에 대한 정보를 알 수 있다.
5. 모듈 최상위 레벨의 this는 undefined
    
    cf) 일반 스크립트의 최상위 this는 전역객체(window)
    

## 브라우저 특정 기능

브라우저 환경에서 
`type=”module”`이 붙은 스크립트와 일반 스크립트의 차이점

1. 모듈 스크립트는 항상 지연 실행된다.
(외부, 인라인 스크립트와 관계없이 defer 속성을 붙인 것 처럼 실행)
    
    **주의해야하는 이유??
    페이지 내 특정 기능이 모듈 스크립트에 의존적인 경우,
    모듈이 완전히 로딩되기 전에 페이지가 먼저 노출되면 사용자가 혼란을 느낄 수 있기 때문**
    
2. 모듈 스크립트에서는 async 속성을 인라인 스크립트에 적용할 수 있다.
cf) 일반 스크립트에서 async 속성은 외부 스크립트를 불러올 때만 유효
    
    **어디에도 종속되지 않는 기능을 구현할 때 유용하게 사용 가능
    (ex. 광고, 문서 레벨 이벤트 리스너, 카운터 등)**
    
3. 외부 스크립트
    1. src 속성값이 동일한 외부 스크립트는 한 번만 실행된다.
    2. 외부 사이트 같이 다른 오리진에서 모듈 스크립트를 불러오려면 CORS 헤더가 필요하다. — 보안 강화
4. 경로가 없는 모듈은 허용되지 않는다.
따라서 브라우저 환경에서 `import`는 반드시 URL 앞에 와야한다.

## 빌드 툴

- 브라우저 환경에서 모듈을 단독으로 쓰기 보단, 웹팩(Webpack)과 같은 특별한 툴을 사용해 모듈을 번들링 후 프로덕션 서버에 올리는 방식을 사용함.
- 번들러를 사용하면??
모듈 분해를 통제할 수 있음 + 경로가 없는 모듈이나 CSS, HTML 모듈을 사용할 수 있게 해줌
- 번들링 과정 이후 import, export가 사라지기 때문에 type=”module” 이 필요 없어짐 → 일반 스크립트 같이 취급 가능

### 빌드 툴의 역할

1. 주요(main) 모듈 선택
2. 주요 모듈에 의존하고 있는 모듈 분석으로 모듈 간의 의존 관계 파악
3. 모든 모듈을 모아 하나의 파일로 만듦
4. 3번 과정 중 변형과 최적화 수행
    - 도달 불가능한 코드 삭제
    - 내보내기 모듈 중 쓰이지 않는 모듈 삭제
    - consolem debugger 같은 개발 관련 코드 삭제
    - 동일한 기능을 하는 낮은 버전의 스크립트로 변환 — 바벨 사용
    - 크기 줄임(공백제거, 변수 이름 줄이기 등)

# 2️⃣ 모듈 내보내고 가져오기

## 내보내기 방법

1. 선언부 앞에 export
2. 선언부와 떨어진 곳에 export(마지막줄, 선언 위 등등)
3. `export 원래 이름 ‘as’ 변경하고 싶은 이름` 로 이름 바꿔서 내보내기
4. export default 
사용하면 좋은 점 ?? 
‘해당 모듈엔 개체가 하나만 있다’는 사실을 명시함
default로 내보내면 중괄호{} 없이 가져오기 가능

## 가져오기 방법

1. 한꺼번에 모든 걸 가져오기 — import * as <obj> 
이 방법 보다 가져올 대상을 구체적으로 명시해주는 게 좋음
    
    이유??
    1) 어차피 번들링과 최적화 과정에서 안쓰이는 리소스는 삭제
    2) 이름을 간결하게 써줄 수 있음
    (`<obj>.함수명` 대신 `함수명`만 적어도 사용 가능)
    3) 코드 구조를 파악하기 쉬워 리팩토링이나 유지보수에 도움
    
2. `import 원래 이름 ‘as’ 변경하고 싶은 이름` 로 이름 바꿔서 가져오기

## 다시 내보내기

1. `export … from …` 사용하면 가져온 개체 즉시 다시 내보내기 가능
(단, `export * from "module”` 사용하면 default export는 다시 내보내지지 않음, 2번 방법으로 default는 따로 다시 내보내야함)
    
    ex)
    
    ```jsx
    //1-2 모두 login과 logout을 가지고 온 후 바로 내보내는 코드
    
    //1
    import {login, logout} from './helpers.js';
    export {login, logout};
    
    //2
    export {login, logout} from './helpers.js';
    ```
    
2. `export {default as …}`로 다시 내보내기
